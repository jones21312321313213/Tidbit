{% extends "base/base.html" %}
{% load static %}

{# 1. Override the title for this specific page #}
{% block title %}Tidbit Home{% endblock title %}

{# 3. The Main Content Block - This replaces the center area of base.html #}
{% block content %}
    <div class="mx-auto col-md-7 pt-4 px-5" style="min-height: 300px; max-width: 1000px">
        <h1 class="ms-3 text-left">Decks</h1>

        <div class="p-1 rounded-3 border bg-white shadow-sm border-secondary w-100" 
            style="max-height: 700px; overflow-y: auto;">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                <tr>
                    <th scope="col" class="ps-4 py-3">Deck</th>
                    <th scope="col" class="text-center">New</th>
                    <th scope="col" class="text-center">Learn</th>
                    <th scope="col" class="text-center">Due</th>
                    <th scope="col"></th>
                </tr>
                </thead>
                <tbody>
                {% for deck in decks %}
                <tr>
                    <td class="ps-4 py-3">
                        <div class="fw-bold">
                            <a href="{% url 'deck_detail' deck.slug %}" class="fw-bold text-dark text-decoration-none">
                                {{ deck.name }}
                            </a>
                        </div>
                        <div class="text-muted small">{{ deck.description|truncatechars:30 }}</div>
                    </td>
                    <td class="align-middle text-center text-info fw-bold">0</td>
                    <td class="align-middle text-center text-danger fw-bold">0</td>
                    <td class="align-middle text-center text-success fw-bold">0</td>
                    <td class="align-middle text-end pe-4">
                        <div class="dropdown">
                            <button class="btn btn-sm"
                                    type="button"
                                    data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                <i class="bi bi-gear"></i>
                            </button>

                            <ul class="dropdown-menu dropdown-menu-end shadow-sm">

                                <!-- Delete Deck -->
                                <li>
                                    <a class="dropdown-item text-danger"
                                    data-bs-toggle="modal"
                                    data-bs-target="#deleteDeckModal{{ deck.deckId }}"
                                    style="cursor: pointer;">
                                        <i class="bi bi-trash me-2"></i>
                                        Delete Deck
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </td>
                </tr>

                <!-- DELETE DECK MODAL -->
                <div class="modal fade" id="deleteDeckModal{{ deck.deckId }}" tabindex="-1">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            {% include 'deck/deck_delete.html' with deck=deck %}
                        </div>
                    </div>
                </div>

                {% empty %}
                <tr>
                    <td colspan="5" class="text-center py-3">No decks found.</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

{% endblock content %}

{# 4. If you need to customize the Left Sidebar (e.g. to set 'Home' as active) #}
{% block left_sidebar_nav %}
    {# You can copy the entire sidebar UL here if you need to change the 'active' class #}
    {# Or, simpler: keep the sidebar in base.html and use logic there. #}
    {# For now, leaving this block out means it will use the default sidebar from base.html #}
    {{ block.super }}
{% endblock left_sidebar_nav %}
