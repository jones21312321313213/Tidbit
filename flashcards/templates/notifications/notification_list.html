{% extends "base/base.html" %}
{% load static %}

{# 1. Override the title for this specific page #}
{% block title %}Decks Due Today{% endblock title %}

{# 3. The Main Content Block - This replaces the center area of base.html #}
{% block content %}
    <div class="mx-auto col-md-7 pt-4 px-5" style="min-height: 300px; max-width: 800px">

        <div class="p-4 rounded-3 border bg-white shadow-sm border-secondary w-100">

            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="fw-normal">Notifications</h2>
                <form method="get" class="d-flex align-items-center">
                    <div class="me-2 small text-muted">Filter:</div>
                    <select name="filter" class="form-select form-select-sm" onchange="this.form.submit()">
                        <option value="all" {% if filter == 'all' %}selected{% endif %}>All ({{ counts.all }})</option>
                        <option value="unread" {% if filter == 'unread' %}selected{% endif %}>Unread ({{ counts.unread }})</option>
                        <option value="read" {% if filter == 'read' %}selected{% endif %}>Read ({{ counts.read }})</option>
                    </select>
                </form>
            </div>

            {% if notifications %}
                <ul class="list-group">
                    {% for note in notifications %}
                        <li class="list-group-item d-flex justify-content-between align-items-center {% if not note.status %}list-group-item-warning{% endif %}">
                            <div>
                                <div class="fw-bold">{{ note.description }}</div>
                                <div class="small text-muted">{{ note.schedule|date:"SHORT_DATETIME_FORMAT" }}</div>
                            </div>
                            <div class="text-end">
                                {% if not note.status %}
                                    <form method="post" action="{% url 'notification_read' note.notificationId %}">
                                        {% csrf_token %}
                                        <input type="hidden" name="filter" value="{{ filter }}">
                                        <button type="submit" class="btn btn-sm btn-outline-primary">Mark as read</button>
                                    </form>
                                {% else %}
                                    <span class="badge bg-secondary">Read</span>
                                {% endif %}
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <div class="text-center text-muted py-4">No notifications to show.</div>
            {% endif %}

        </div>

    </div>
{% endblock content %}